    .then(response => response.json())
    .then(data => {
        if (data.user) {
            currentUser = data.user;
            document.getElementById('sellerName').textContent = currentUser.name;
        } else {
            localStorage.removeItem('token');
            window.location.href = '/';
        }
    })
    .catch(error => {
        console.error('Auth error:', error);
        localStorage.removeItem('token');
        window.location.href = '/';
    });
}

function setupEventListeners() {
    // Add product form
    document.getElementById('addProductForm').addEventListener('submit', handleAddProduct);
}

async function loadCategories() {
    try {
        const response = await fetch(API_BASE + '/api/categories');
        const data = await response.json();
        
        if (response.ok) {
            const categorySelect = document.getElementById('productCategory');
            data.categories.forEach(category => {
                const option = document.createElement('option');
                option.value = category.id;
                option.textContent = category.name;
                categorySelect.appendChild(option);
            });
        }
    } catch (error) {
        console.error('Error loading categories:', error);
    }
}

function loadDashboardData() {
    loadCategories();
    loadStats();
    loadProducts();
    loadSales();
    loadNotifications();
}

function loadStats() {
